import{a as Rt}from"./chunk-OD4FTP4P.js";import{a as X,b as wt,c as kt,d as Tt,f as Dt,g as It}from"./chunk-7FHMHPOG.js";import{a as Lt,b as Ot,c as Bt,d as Pt,e as Vt,f as Nt,i as Ht,k as At,r as $t}from"./chunk-WO3WQ2XR.js";import{b as yt}from"./chunk-OYAAD6H2.js";import{a as q}from"./chunk-NS5OZLHL.js";import{a as Ft}from"./chunk-Y3YQYZ4W.js";import{A as Ct,B as R,G as z,I as G,K as U,a as k,b as T,c as pt,d as gt,e as ft,f as ht,g as P,l as V,n as xt,o as Mt,r as bt,s as N,u as St,v as H,x as A,y as vt,z as $}from"./chunk-JQ7ZTRAQ.js";import{a as j}from"./chunk-XHZ33VBC.js";import{$ as st,M as D,O as at,P as I,R as L,T as h,V as O,W as lt,X as mt,Z as S,ba as dt,ca as ct,da as ut,ma as B}from"./chunk-4LHVJXPR.js";import{C as w,d as rt,k as E}from"./chunk-SMWCLUEH.js";import{a as _t,b as Et}from"./chunk-VYQ2GNAY.js";import{Ab as b,Cb as Y,Db as tt,Eb as u,Fb as t,Gb as i,Hb as c,Mb as Z,Qb as p,S as x,Sb as f,Wa as m,ac as et,ba as s,ec as o,f as C,fc as it,ga as y,gb as _,gc as g,ha as F,ia as J,ja as Q,mb as W,oc as nt,xc as ot,zb as M}from"./chunk-JOOEKZTP.js";import"./chunk-2VMXMS7J.js";function ae(a,e){if(a&1&&(t(0,"mat-error"),o(1),i()),a&2){let n=f();m(),g(" ",n.getErrorDesignation()," ")}}function le(a,e){if(a&1&&(t(0,"mat-error"),o(1),i()),a&2){let n=f();m(),g(" ",n.getErrorAcronym()," ")}}var v=class a{dialogRef=s(wt);message=s(q);data=s(kt);http=s(j);unsubscribe$=new C;form;function;ngOnInit(){this.initForm()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}initForm(){this.form=new mt({designation:new S(this.data.function?this.data.function.designation:"",[h.required,h.minLength(2),h.maxLength(100)]),acronym:new S(this.data.function?this.data.function.acronym:"",[h.required,h.minLength(1),h.maxLength(10)])})}getErrorDesignation(){return this.form.get("designation").hasError("required")?"Ce champ est requis":this.form.get("designation").hasError("minlength")?"La d\xE9signation doit contenir au moins 2 caract\xE8res.":this.form.get("designation").hasError("maxlength")?"La d\xE9signation ne peut pas d\xE9passer 100 caract\xE8res.":""}getErrorAcronym(){return this.form.get("acronym").hasError("required")?"Ce champ est requis":this.form.get("acronym").hasError("minlength")?"L'acronyme doit contenir au moins 1 caract\xE8res.":this.form.get("acronym").hasError("maxlength")?"L'acronyme ne peut pas d\xE9passer 10 caract\xE8res.":""}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched(),this.message.openSnackBar("Veuillez corriger les erreurs du formulaire.","Fermer",4e3);return}this.data.target==="add"?this.add():this.update()}add(){this.http.url="functions",this.http.save(this.form.value).pipe(x(this.unsubscribe$)).subscribe({next:e=>{this.function=e},error:e=>{this.message.openSnackBar(e,"Fermer",4e3)},complete:()=>{this.message.openSnackBar("Fonction ajout\xE9e avec succ\xE8s","Fermer",4e3),this.dialogRef.close(this.function)}})}update(){this.http.url=`functions/${this.data.function.id}`,this.http.update(this.form.value).pipe(x(this.unsubscribe$)).subscribe({next:e=>{this.function=e},error:e=>{this.message.openSnackBar(e,"Fermer",4e3)},complete:()=>{this.message.openSnackBar("Fonction modifi\xE9e avec succ\xE8s","Fermer",4e3),this.dialogRef.close(this.function)}})}onClose(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=_({type:a,selectors:[["app-function-edit-component"]],decls:24,vars:4,consts:[[1,"flex","items-center","justify-between","px-4","py-2","bg-white","dark:bg-gray-900","shadow-sm"],[1,"text-lg","font-semibold","text-gray-800","dark:text-gray-300"],["mat-icon-button","",3,"click"],[1,"-mx-3","md:-mx-0",3,"ngSubmit","formGroup"],[1,"w-full","mt-1"],[1,"w-full"],["type","text","matInput","","formControlName","designation"],["type","text","matInput","","formControlName","acronym"],[1,"mt-5"],[1,"border-gray-300"],["mat-flat-button","","cdkFocusInitial","",3,"click"]],template:function(n,r){if(n&1&&(t(0,"div",0)(1,"h2",1),o(2),i(),t(3,"button",2),p("click",function(){return r.onClose()}),t(4,"mat-icon"),o(5,"close"),i()()(),t(6,"mat-dialog-content")(7,"form",3),p("ngSubmit",function(){return r.onSubmit()}),t(8,"div",4)(9,"mat-form-field",5)(10,"mat-label"),o(11,"D\xE9signation de la fonction"),i(),c(12,"input",6),M(13,ae,2,1,"mat-error"),i(),t(14,"mat-form-field",5)(15,"mat-label"),o(16,"Acronyme de la fonction"),i(),c(17,"input",7),M(18,le,2,1,"mat-error"),i()()()(),t(19,"div",8),c(20,"hr",9),i(),t(21,"mat-dialog-actions")(22,"button",10),p("click",function(){return r.onSubmit()}),o(23," Enregister "),i()()),n&2){let l,d;m(2),g(" ",r.data.title," "),m(5),u("formGroup",r.form),m(6),b((l=r.form.get("designation"))!=null&&l.hasError?13:-1),m(5),b((d=r.form.get("acronym"))!=null&&d.hasError?18:-1)}},dependencies:[Dt,It,E,T,k,I,at,D,w,B,st,L,O,lt,ct,ut,P,V,N,bt,xt,Mt,H,St,A,$,R,z,G,U],styles:[".mat-mdc-dialog-container .mdc-dialog__surface{border-radius:0!important}"]})};var me=a=>({item:a}),se=(a,e)=>e.id;function de(a,e){if(a&1&&(t(0,"span",3),o(1),i()),a&2){let n=f();m(),g(" Toutes les directions (",n.allUFunctions.length,") ")}}function ce(a,e){a&1&&(t(0,"mat-button-toggle-group",12)(1,"mat-button-toggle",33)(2,"span"),o(3,"Affichage Grille"),i(),t(4,"mat-icon",34),o(5,"view_list"),i()(),t(6,"mat-button-toggle",35)(7,"span"),o(8,"Affichage tableau"),i(),t(9,"mat-icon",34),o(10,"view_module"),i()()())}function ue(a,e){if(a&1&&(t(0,"tr")(1,"td",36)(2,"div")(3,"h4",37),o(4),i()()(),t(5,"td",36)(6,"div")(7,"h2",38),o(8),i()()(),t(9,"td",39),o(10),i(),t(11,"td",36)(12,"button",40)(13,"mat-icon"),o(14,"more_vert"),i()()()()),a&2){let n=e.$implicit,r=e.$index;f();let l=et(45);m(4),it(r+1),m(4),g(" ",n.designation," "),m(2),g(" ",n.acronym," "),m(2),u("matMenuTriggerFor",l)("matMenuTriggerData",nt(5,me,n))}}function pe(a,e){if(a&1){let n=Z();t(0,"button",41),p("click",function(){let l=y(n).item,d=f();return F(d.onUpdateDialog(l))}),t(1,"mat-icon"),o(2,"edit"),i(),o(3,"Modifier "),i(),t(4,"button",42)(5,"mat-icon"),o(6,"person"),i(),t(7,"span"),o(8,"Directeur"),i()(),c(9,"mat-divider"),t(10,"button",42)(11,"mat-icon"),o(12,"delete"),i(),t(13,"span"),o(14,"Supprimer"),i()()}}var zt=class a{http=s(j);message=s(q);stateService=s(Et);dialog=s(Tt);xSmallOrSmall=ot(()=>this.stateService.XSmallOrSmall());unsubscribe$=new C;loading=!1;allUFunctions=[];filteredFunctions=[];paginatedFunctions=[];totalLength=0;currentPage=0;pageSizeOptions=[6,10,15,20];pageSize=this.pageSizeOptions[0];searchKeyword=new S("");roles=Ft;constructor(){this.stateService.setHeader(new _t("GESTION DES FONCTIONS","Liste des toutes les fonctions","work_outline"))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnInit(){this.onGet(),this.setupSearch()}onGet(){this.loading=!0,this.http.url="functions",this.unsubscribe$.next(),this.http.get().pipe(x(this.unsubscribe$)).subscribe({next:e=>{this.allUFunctions=e,this.filteredFunctions=e},error:e=>{this.loading=!1,this.message.openSnackBar(e,"Fermer",800)},complete:()=>{this.loading=!1,this.totalLength=this.filteredFunctions.length,this.updatePaginated()}})}setupSearch(){this.searchKeyword.valueChanges.pipe(x(this.unsubscribe$)).subscribe(e=>{this.applyFilter(e)})}applyFilter(e){let n=e?e.toLowerCase().trim():"";this.filteredFunctions=this.allUFunctions.filter(r=>r.designation.toLowerCase().includes(n)),this.totalLength=this.filteredFunctions.length,this.currentPage=0,this.updatePaginated()}updatePaginated(){let e=this.currentPage*this.pageSize,n=e+this.pageSize;this.paginatedFunctions=this.filteredFunctions.slice(e,n)}onPageChange(e){this.currentPage=e.pageIndex,this.pageSize=e.pageSize,this.updatePaginated()}onAddDialog(e){let n=new X;n.disableClose=!0,n.data={title:"Ajouter une direction",function:e,target:"add"},this.dialog.open(v,n).afterClosed().subscribe(l=>{l&&(this.allUFunctions.push(l),this.applyFilter(this.searchKeyword.value))})}onUpdateDialog(e){let n=new X;n.disableClose=!0,n.data={title:"Modifier une direction",function:e,target:"edit"},this.dialog.open(v,n).afterClosed().subscribe(l=>{if(l){let d=this.filteredFunctions.findIndex(K=>K.id===l.id);d!==-1&&(this.filteredFunctions[d]=l,this.updatePaginated())}})}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=_({type:a,selectors:[["app-function-component"]],decls:48,vars:9,consts:[["menu","matMenu"],[1,"flex","items-center","justify-between","md:h-16","md:px-4","border-b","border-b-gray-300","md:border-b-0","py-2","md:py-0",3,"ngClass"],[1,"flex","gap-2"],[1,"text-lg"],["mat-icon-button","","matTooltip","Nouveau courrier",3,"click"],["mat-icon-button","","matTooltip","Imprimer"],[1,"flex","flex-wrap","my-4","md:mt-6"],[1,"w-full","lg:w-4/12"],[1,"relative","w-full"],["type","text","placeholder","Rechercher un courrier par mot cl\xE9",1,"w-full","p-3","pl-5","pr-15","text-lg","border-2","border-gray-300","md:rounded-full","outline-none","transition","duration-300","focus:border-blue-500","focus:text-gray-700","bg-white","h-[45px]","lg:h-[49px]",3,"formControl"],[1,"absolute","right-4","top-1/2","transform","-translate-y-1/2","text-gray-500","text-lg"],[1,"w-full","lg:w-8/12","flex","justify-end","items-center","flex-wrap","mt-3","md:mt-0"],["value","add"],[1,"flex","flex-col","md:mt-6"],[1,"overflow-x-auto"],[1,"inline-block","min-w-full","align-middle"],[1,"overflow-hidden","border-y","border-gray-200","dark:border-gray-700","md:rounded-lg"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700"],[1,"bg-gray-50","dark:bg-gray-800"],["scope","col",1,"px-4","py-3.5","text-sm","font-normal","text-left","rtl:text-right","text-gray-500","dark:text-gray-400"],["scope","col",1,"py-3.5","px-4","text-sm","font-normal","text-left","rtl:text-right","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","gap-x-3","focus:outline-none"],["viewBox","0 0 10 11","fill","none","xmlns","http://www.w3.org/2000/svg",1,"h-3"],["d","M2.13347 0.0999756H2.98516L5.01902 4.79058H3.86226L3.45549 3.79907H1.63772L1.24366 4.79058H0.0996094L2.13347 0.0999756ZM2.54025 1.46012L1.96822 2.92196H3.11227L2.54025 1.46012Z","fill","currentColor","stroke","currentColor","stroke-width","0.1"],["d","M0.722656 9.60832L3.09974 6.78633H0.811638V5.87109H4.35819V6.78633L2.01925 9.60832H4.43446V10.5617H0.722656V9.60832Z","fill","currentColor","stroke","currentColor","stroke-width","0.1"],["d","M8.45558 7.25664V7.40664H8.60558H9.66065C9.72481 7.40664 9.74667 7.42274 9.75141 7.42691C9.75148 7.42808 9.75146 7.42993 9.75116 7.43262C9.75001 7.44265 9.74458 7.46304 9.72525 7.49314C9.72522 7.4932 9.72518 7.49326 9.72514 7.49332L7.86959 10.3529L7.86924 10.3534C7.83227 10.4109 7.79863 10.418 7.78568 10.418C7.77272 10.418 7.73908 10.4109 7.70211 10.3534L7.70177 10.3529L5.84621 7.49332C5.84617 7.49325 5.84612 7.49318 5.84608 7.49311C5.82677 7.46302 5.82135 7.44264 5.8202 7.43262C5.81989 7.42993 5.81987 7.42808 5.81994 7.42691C5.82469 7.42274 5.84655 7.40664 5.91071 7.40664H6.96578H7.11578V7.25664V0.633865C7.11578 0.42434 7.29014 0.249976 7.49967 0.249976H8.07169C8.28121 0.249976 8.45558 0.42434 8.45558 0.633865V7.25664Z","fill","currentColor","stroke","currentColor","stroke-width","0.3"],["scope","col",1,"px-12","py-3.5","text-sm","font-normal","text-left","rtl:text-right","text-gray-500","dark:text-gray-400"],["scope","col",1,"relative","py-3.5","px-4"],[1,"sr-only"],[1,"bg-white","divide-y","divide-gray-200","dark:divide-gray-700","dark:bg-gray-900"],["yPosition","below",3,"overlapTrigger"],["matMenuContent",""],["showFirstLastButtons","",1,"mt-10",3,"page","length","pageSize","pageSizeOptions","pageIndex"],["matTooltip","Nouveau groupe","value","add","aria-label","Text align center"],["color","primary"],["matTooltip","Liste des proclamateurs","value","print","aria-label","Text align center"],[1,"px-4","py-2.5","text-sm","whitespace-nowrap"],[1,"text-gray-700","dark:text-gray-200"],[1,"text-gray-800","dark:text-white"],[1,"px-12","py-2.5","text-sm","whitespace-nowrap"],["mat-icon-button","",3,"matMenuTriggerFor","matMenuTriggerData"],["mat-menu-item","",3,"click"],["mat-menu-item",""]],template:function(n,r){if(n&1){let l=Z();t(0,"section",1)(1,"div",2),c(2,"app-back-component"),i(),M(3,de,2,1,"span",3),t(4,"div")(5,"button",4),p("click",function(){return y(l),F(r.onAddDialog())}),t(6,"mat-icon"),o(7,"add"),i()(),t(8,"button",5)(9,"mat-icon"),o(10,"print"),i()()()(),t(11,"section",6)(12,"div",7)(13,"div",8),c(14,"input",9),t(15,"mat-icon",10),o(16,"search"),i()()(),t(17,"div",11),M(18,ce,11,0,"mat-button-toggle-group",12),i()(),t(19,"div",13)(20,"div",14)(21,"div",15)(22,"div",16)(23,"table",17)(24,"thead",18)(25,"tr")(26,"th",19),o(27," N\xB0 "),i(),t(28,"th",20)(29,"button",21)(30,"span"),o(31,"D\xE9signation"),i(),J(),t(32,"svg",22),c(33,"path",23)(34,"path",24)(35,"path",25),i()()(),Q(),t(36,"th",26),o(37," Acronyme "),i(),t(38,"th",27)(39,"span",28),o(40,"Edit"),i()()()(),t(41,"tbody",29),Y(42,ue,15,7,"tr",null,se),i()()()()()(),t(44,"mat-menu",30,0),W(46,pe,15,0,"ng-template",31),i(),t(47,"mat-paginator",32),p("page",function(K){return y(l),F(r.onPageChange(K))}),i()}n&2&&(u("ngClass",r.xSmallOrSmall()?"":"u-bg-header-main"),m(3),b(r.xSmallOrSmall()?-1:3),m(11),u("formControl",r.searchKeyword),m(4),b(r.xSmallOrSmall()?-1:18),m(24),tt(r.paginatedFunctions),m(2),u("overlapTrigger",!1),m(3),u("length",r.totalLength)("pageSize",r.pageSize)("pageSizeOptions",r.pageSizeOptions)("pageIndex",r.currentPage))},dependencies:[Ot,Lt,Bt,Nt,Pt,Vt,Ht,At,N,V,yt,$t,E,rt,T,k,I,D,w,B,L,O,dt,P,ft,pt,gt,ht,H,A,$,vt,R,Ct,z,G,U,Rt],encapsulation:2})};export{zt as FunctionComponent};
