import{a as Ce}from"./chunk-PYNVKXPF.js";import"./chunk-Y3YQYZ4W.js";import{a as _e,b as Se,c as fe,d as ge,e as ke,f as we,g as ve,h as xe,i as Ee,j as Te,k as Me}from"./chunk-JOP7NNSZ.js";import{A as se,B as ce,G as de,I as ue,J as pe,K as he,a as F,b as H,c as K,e as Q,f as Z,g as q,i as ee,j as te,k as ie,l as ne,s as re,v as ae,x as oe,y as le,z as me}from"./chunk-LN33XJJG.js";import{a as ye}from"./chunk-2KDJOZPQ.js";import{M as W,P as $,b as J,c as S,ma as Y}from"./chunk-6K6YQ32S.js";import{A as G,B as z,D as U,l as X,y as P,z as j}from"./chunk-DDJAZSWD.js";import{b as be}from"./chunk-WRDENF74.js";import{$ as I,Ab as M,Bb as A,Cb as R,Db as B,Eb as v,Fb as e,Gb as t,Hb as _,Mb as E,Qb as d,S as b,Sb as x,Wa as m,Y as C,aa as L,ac as u,ba as w,bc as N,cc as f,ec as i,f as y,ga as s,gb as O,gc as g,ha as c,xc as D,yb as V,zb as T}from"./chunk-D6M5U3FV.js";import"./chunk-MGTJOKXF.js";var Ae=new I("JWT_OPTIONS"),Ie=(()=>{class p{constructor(r=null){this.tokenGetter=r&&r.tokenGetter||function(){}}urlBase64Decode(r){let n=r.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:{n+="==";break}case 3:{n+="=";break}default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(n)}b64decode(r){let n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="";if(r=String(r).replace(/=+$/,""),r.length%4===1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let l=0,o,k,Oe=0;k=r.charAt(Oe++);~k&&(o=l%4?o*64+k:k,l++%4)?a+=String.fromCharCode(255&o>>(-2*l&6)):0)k=n.indexOf(k);return a}b64DecodeUnicode(r){return decodeURIComponent(Array.prototype.map.call(this.b64decode(r),n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(r=this.tokenGetter()){return r instanceof Promise?r.then(n=>this._decodeToken(n)):this._decodeToken(r)}_decodeToken(r){if(!r||r==="")return null;let n=r.split(".");if(n.length!==3)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");let a=this.urlBase64Decode(n[1]);if(!a)throw new Error("Cannot decode the token.");return JSON.parse(a)}getTokenExpirationDate(r=this.tokenGetter()){return r instanceof Promise?r.then(n=>this._getTokenExpirationDate(n)):this._getTokenExpirationDate(r)}_getTokenExpirationDate(r){let n;if(n=this.decodeToken(r),!n||!n.hasOwnProperty("exp"))return null;let a=new Date(0);return a.setUTCSeconds(n.exp),a}isTokenExpired(r=this.tokenGetter(),n){return r instanceof Promise?r.then(a=>this._isTokenExpired(a,n)):this._isTokenExpired(r,n)}_isTokenExpired(r,n){if(!r||r==="")return!0;let a=this.getTokenExpirationDate(r);return n=n||0,a===null?!1:!(a.valueOf()>new Date().valueOf()+n*1e3)}getAuthScheme(r,n){return typeof r=="function"?r(n):r}}return p.\u0275fac=function(r){return new(r||p)(L(Ae))},p.\u0275prov=C({token:p,factory:p.\u0275fac}),p})();function Re(p,h){if(p&1){let r=E();e(0,"button",44)(1,"mat-icon",45),i(2,"notifications"),t()(),e(3,"button",46)(4,"mat-icon"),i(5,"account_circle"),t()(),e(6,"mat-menu",10,2)(8,"button",47),d("click",function(){s(r);let a=x();return c(a.logout())}),e(9,"mat-icon"),i(10,"launch"),t(),i(11,"D\xE9connexion "),t(),e(12,"button",11)(13,"mat-icon"),i(14,"help"),t(),e(15,"span"),i(16,"Aide"),t()()()}if(p&2){let r=u(7);m(3),v("matMenuTriggerFor",r),m(3),v("overlapTrigger",!1)}}function Be(p,h){if(p&1){let r=E();e(0,"button",47),d("click",function(){let a=s(r).$implicit,l=x();return c(l.onChangeRole(a))}),i(1),t()}if(p&2){let r=h.$implicit,n=x();m(),g(" ",n.roleService.build(r)," ")}}function Ne(p,h){if(p&1&&(i(0),_(1,"br"),i(2)),p&2){let r=x();g(" ",r.authentication.full_name," "),m(2),g(" ",r.roleLabel," ")}}function De(p,h){p&1&&i(0," Utilisateur anonyme ")}var Le=class p{stateService=w(be);http=w(ye);router=w(j);roleService=w(Ce);toggle=!1;switch=!1;currentScreenSize;XSmallOrSmall=!1;destroyed=new y;displayNameMap=new Map([[S.XSmall,"XSmall"],[S.Small,"Small"],[S.Medium,"Medium"],[S.Large,"Large"],[S.XLarge,"XLarge"]]);authentication;header=D(()=>this.stateService.header());roles=[];roleLabel="";constructor(){if(sessionStorage.getItem("authentication")){this.authentication=JSON.parse(sessionStorage.getItem("authentication")),this.http.authentication=this.authentication;let h=new Ie;this.http.roles=h.decodeToken(this.authentication.authorization).scope,this.http.role=h.decodeToken(this.authentication.authorization).scope,this.roles=this.http.roles.split(" "),this.buildRoles()}w(J).observe([S.XSmall,S.Small,S.Medium,S.Large,S.XLarge]).pipe(b(this.destroyed)).subscribe(h=>{for(let r of Object.keys(h.breakpoints))h.breakpoints[r]&&(this.currentScreenSize=this.displayNameMap.get(r)??"Unknown",this.XSmallOrSmall=this.currentScreenSize==="XSmall"||this.currentScreenSize==="Small",this.stateService.setXSmallOrSmall(this.XSmallOrSmall))})}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}onSwitch(){this.switch=!this.switch,document.body.classList.toggle("dark-mode"),this.stateService.setState(this.switch)}buildRoles(){if(sessionStorage.getItem("role")){let h=sessionStorage.getItem("role");this.onChangeRole(h)}else this.http.roles.includes("DIRECTOR")?this.onChangeRole("DIRECTOR"):this.http.roles.includes("SENIOR_ASSISTANT")?this.onChangeRole("SENIOR_ASSISTANT"):this.http.roles.includes("ADMIN_ASSISTANT")?this.onChangeRole("ADMIN_ASSISTANT"):this.http.roles.includes("MAIL_ARCHIVES_AGENT")?this.onChangeRole("MAIL_ARCHIVES_AGENT"):this.http.roles.includes("EXECUTIVE_SECRETARY")?this.onChangeRole("EXECUTIVE_SECRETARY"):this.onChangeRole("AGENT")}onChangeRole(h){this.stateService.setRole(h),this.roleLabel=this.roleService.build(h),sessionStorage.setItem("role",h)}logout(){sessionStorage.clear(),this.router.navigateByUrl("/")}static \u0275fac=function(r){return new(r||p)};static \u0275cmp=O({type:p,selectors:[["app-layout-backend-component"]],decls:188,vars:32,consts:[["role",""],["drawer",""],["accountMenu",""],[1,"layout-container"],["color","primary",1,"layout-toolbar","shadow-sm","z-[2]"],["mat-icon-button","",3,"click"],[1,"pl-4","flex","items-center"],["src","assets/images/logo.PNG","alt","Logo CNSSAP",1,"h-8"],[2,"flex","1 1 auto"],["mat-icon-button","",3,"matMenuTriggerFor"],["yPosition","below",3,"overlapTrigger"],["mat-menu-item",""],["mat-icon-button","",1,"ms-3",3,"click"],["color","primary"],[1,"layout-sidenav-container"],["fixedTopGap","56",3,"fixedInViewport","mode","opened"],[1,"p-6","bg-white","min-h-28"],["src","assets/images/avatar.png","alt","avatart",1,"h-16"],[1,"text-right"],["dense","","expanded",""],["matListItemIcon","",1,"me-3"],["dense",""],["routerLink","/dashboard",3,"click"],["routerLinkActive","active","matListItemTitle",""],["routerLink","/aide",3,"click"],["routerLink","/mails/incoming/external",3,"click"],["routerLink","/mails/incoming/internal",3,"click"],["routerLink","/mails/outgoing/external",3,"click"],["routerLink","/mails/outgoing/internal",3,"click"],["routerLink","/documents",3,"click"],["routerLink","/groupes/new",3,"click"],["routerLink","/departments",3,"click"],["routerLink","/functions",3,"click"],["routerLink","/users",3,"click"],["routerLink","/groupes",3,"click"],[1,"min-h-full","flex","flex-col","bg-[#f0f3f5]"],[1,"p-5","bg-[#f7f9fa]","flex","gap-5","items-center"],[1,"bg-white","p-4","shadow-lg"],[2,"color","#f9d4dd"],[1,"app-text-title"],[1,"page-title-subheading","lg:mt-1"],[1,"mx-3.5","md:mx-6","my-6","md:my-8"],[1,"bg-[#fafbfc]","mt-auto","p-4","sm:p-6","shadow-lg","shadow-black"],[1,"text-center"],["mat-icon-button","",1,"me-1"],["matBadge","15","matBadgeColor","accent"],["mat-icon-button","","matTooltip","My Account",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"]],template:function(r,n){if(r&1){let a=E();e(0,"div",3)(1,"mat-toolbar",4)(2,"button",5),d("click",function(){s(a);let o=u(22);return c(o.toggle())}),e(3,"mat-icon"),i(4,"menu"),t()(),e(5,"div",6),_(6,"img",7),t(),_(7,"span",8),e(8,"div"),T(9,Re,17,2),e(10,"button",9)(11,"mat-icon"),i(12,"keyboard_arrow_down"),t()(),e(13,"mat-menu",10,0),R(15,Be,2,1,"button",11,A),t(),e(17,"button",12),d("click",function(){return s(a),c(n.onSwitch())}),e(18,"mat-icon",13),i(19),t()()()(),e(20,"mat-sidenav-container",14)(21,"mat-sidenav",15,1)(23,"div",16),_(24,"img",17),e(25,"div",18),T(26,Ne,3,2)(27,De,1,0),_(28,"br"),t()(),e(29,"mat-accordion"),_(30,"mat-divider"),e(31,"mat-expansion-panel",19)(32,"mat-expansion-panel-header")(33,"mat-icon",20),i(34,"home"),t(),i(35,"\xA0Accueil "),t(),e(36,"mat-nav-list",21)(37,"mat-list-item",22),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(38,"mat-icon",20),i(39,"dashboard"),t(),e(40,"span",23),i(41,"Dashboard"),t()(),e(42,"mat-list-item",24),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(43,"mat-icon",20),i(44,"help"),t(),e(45,"span",23),i(46,"Aide"),t()(),e(47,"mat-list-item",24),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(48,"mat-icon",20),i(49,"question_answer"),t(),e(50,"span",23),i(51,"A propos"),t()()()(),_(52,"mat-divider"),e(53,"mat-expansion-panel",21)(54,"mat-expansion-panel-header")(55,"mat-icon",20),i(56,"trending_down"),t(),i(57,"\xA0Courries entrants "),t(),e(58,"mat-nav-list",21)(59,"mat-list-item",25),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(60,"mat-icon",20),i(61,"call_made"),t(),e(62,"span",23),i(63,"Externes"),t()(),e(64,"mat-list-item",26),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(65,"mat-icon",20),i(66,"call_received"),t(),e(67,"span",23),i(68,"Internes"),t()()()(),_(69,"mat-divider"),e(70,"mat-expansion-panel",21)(71,"mat-expansion-panel-header")(72,"mat-icon",20),i(73,"trending_up"),t(),i(74,"\xA0Courriers sortants "),t(),e(75,"mat-nav-list",21)(76,"mat-list-item",27),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(77,"mat-icon",20),i(78,"supervisor_account"),t(),e(79,"span",23),i(80,"Externes"),t()(),e(81,"mat-list-item",28),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(82,"mat-icon",20),i(83,"settings_applications"),t(),e(84,"span",23),i(85,"Internes"),t()()()(),_(86,"mat-divider"),e(87,"mat-expansion-panel",21)(88,"mat-expansion-panel-header")(89,"mat-icon",20),i(90,"folder"),t(),i(91,"\xA0Types documents "),t(),e(92,"mat-nav-list",21)(93,"mat-list-item",29),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(94,"mat-icon",20),i(95,"list"),t(),e(96,"span",23),i(97,"Tous les types"),t()(),e(98,"mat-list-item",30),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(99,"mat-icon",20),i(100,"add"),t(),e(101,"span",23),i(102,"Nouveau type"),t()()()(),_(103,"mat-divider"),e(104,"mat-expansion-panel",21)(105,"mat-expansion-panel-header")(106,"mat-icon",20),i(107,"event_seat"),t(),i(108,"\xA0Gestion des directions "),t(),e(109,"mat-nav-list",21)(110,"mat-list-item",31),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(111,"mat-icon",20),i(112,"list"),t(),e(113,"span",23),i(114,"Toutes les directions"),t()(),e(115,"mat-list-item",30),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(116,"mat-icon",20),i(117,"add"),t(),e(118,"span",23),i(119,"Nouvelle direction"),t()()()(),_(120,"mat-divider"),e(121,"mat-expansion-panel",21)(122,"mat-expansion-panel-header")(123,"mat-icon",20),i(124,"work_outline"),t(),i(125,"\xA0Gestion des fonctions "),t(),e(126,"mat-nav-list",21)(127,"mat-list-item",32),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(128,"mat-icon",20),i(129,"list"),t(),e(130,"span",23),i(131,"Toutes les fonctions"),t()(),e(132,"mat-list-item",30),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(133,"mat-icon",20),i(134,"add"),t(),e(135,"span",23),i(136,"Noulle fonction"),t()()()(),_(137,"mat-divider"),e(138,"mat-expansion-panel",21)(139,"mat-expansion-panel-header")(140,"mat-icon",20),i(141,"people"),t(),i(142,"\xA0Gestion des utilisateurs "),t(),e(143,"mat-nav-list",21)(144,"mat-list-item",33),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(145,"mat-icon",20),i(146,"list"),t(),e(147,"span",23),i(148,"Tous les utilisateurs"),t()(),e(149,"mat-list-item",22),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(150,"mat-icon",20),i(151,"add"),t(),e(152,"span",23),i(153,"Nouveau utilisateur"),t()()()(),_(154,"mat-divider"),e(155,"mat-expansion-panel",21)(156,"mat-expansion-panel-header")(157,"mat-icon",20),i(158,"devices"),t(),i(159,"\xA0Courriers archiv\xE9s "),t(),e(160,"mat-nav-list",21)(161,"mat-list-item",34),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(162,"mat-icon",20),i(163,"send"),t(),e(164,"span",23),i(165,"Invitations"),t()(),e(166,"mat-list-item",30),d("click",function(){s(a);let o=u(22);return c(o.toggle(!n.XSmallOrSmall))}),e(167,"mat-icon",20),i(168,"weekend"),t(),e(169,"span",23),i(170,"Ticket"),t()()()(),_(171,"mat-divider"),t()(),e(172,"mat-sidenav-content")(173,"div",35)(174,"div",36)(175,"div",37)(176,"mat-icon",38),i(177),t()(),e(178,"div")(179,"span",39),i(180),t(),e(181,"div",40),i(182),t()()(),e(183,"main",41),_(184,"router-outlet"),t(),e(185,"footer",42)(186,"p",43),i(187,"\xA9 Copyright 2025 CNSSAP"),t()()()()()()}if(r&2){let a=u(14);f("layout-is-mobile",n.XSmallOrSmall),m(9),M(n.XSmallOrSmall?-1:9),m(),v("matMenuTriggerFor",a),m(3),v("overlapTrigger",!1),m(2),B(n.roles),m(4),g(" ",n.switch?"wb_sunny":"brightness_2"," "),m(),N("margin-top",n.XSmallOrSmall?56:0,"px"),m(),v("fixedInViewport",n.XSmallOrSmall)("mode",n.XSmallOrSmall?"over":"side")("opened",n.XSmallOrSmall===!1),V("role",n.XSmallOrSmall?"dialog":"navigation"),m(5),M(n.authentication?26:27),m(5),f("mat-elevation-z0",!0),m(22),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(22),g(" ",n.header().icon," "),m(3),g(" ",n.header().title," "),m(2),g(" ",n.header().subTitle," ")}},dependencies:[X,H,F,$,W,U,P,G,z,Y,q,Q,K,Z,ne,ie,ee,te,re,ae,oe,me,le,ce,se,de,ue,he,pe,Se,_e,we,ge,ke,fe,Me,Te,Ee,xe,ve],styles:["mat-sidenav[_ngcontent-%COMP%]{width:290px;border-radius:0;box-shadow:3px 0 8px #0000001a}.bg-footer[_ngcontent-%COMP%]{background:#fafbfc}"]})};export{Le as LayoutBackendComponent};
