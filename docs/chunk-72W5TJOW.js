import"./chunk-Y3YQYZ4W.js";import{a as he,b as _e,c as fe,d as ge,e as ke,f as we,g as ve,h as Ee,i as xe,j as Te,k as Me}from"./chunk-GZVQUYCV.js";import{A as se,B as ce,G as de,I as ue,J as pe,K as Se,a as J,b as F,c as K,e as Q,f as Z,g as q,i as ee,j as te,k as ie,l as ne,s as re,v as ae,x as oe,y as le,z as me}from"./chunk-JQ7ZTRAQ.js";import{a as be}from"./chunk-XHZ33VBC.js";import{M as W,P as $,b as U,c as _,ma as Y}from"./chunk-4LHVJXPR.js";import{A as z,C as H,k as P,x as j,z as G}from"./chunk-SMWCLUEH.js";import{b as ye}from"./chunk-VYQ2GNAY.js";import{$ as I,$a as E,Ab as T,Bb as V,Cb as N,Db as D,Eb as w,Fb as e,Gb as i,Hb as h,Mb as M,Qb as d,S as y,Sb as v,Wa as m,Y as C,aa as L,ac as u,ba as A,bc as B,cc as f,ec as n,f as b,ga as s,gb as O,gc as g,ha as c,xc as X,yb as R,zb as x}from"./chunk-JOOEKZTP.js";import"./chunk-2VMXMS7J.js";var Oe=new I("JWT_OPTIONS"),Ce=(()=>{class p{constructor(r=null){this.tokenGetter=r&&r.tokenGetter||function(){}}urlBase64Decode(r){let t=r.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:{t+="==";break}case 3:{t+="=";break}default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(t)}b64decode(r){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="";if(r=String(r).replace(/=+$/,""),r.length%4===1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let l=0,o,k,Le=0;k=r.charAt(Le++);~k&&(o=l%4?o*64+k:k,l++%4)?a+=String.fromCharCode(255&o>>(-2*l&6)):0)k=t.indexOf(k);return a}b64DecodeUnicode(r){return decodeURIComponent(Array.prototype.map.call(this.b64decode(r),t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(r=this.tokenGetter()){return r instanceof Promise?r.then(t=>this._decodeToken(t)):this._decodeToken(r)}_decodeToken(r){if(!r||r==="")return null;let t=r.split(".");if(t.length!==3)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");let a=this.urlBase64Decode(t[1]);if(!a)throw new Error("Cannot decode the token.");return JSON.parse(a)}getTokenExpirationDate(r=this.tokenGetter()){return r instanceof Promise?r.then(t=>this._getTokenExpirationDate(t)):this._getTokenExpirationDate(r)}_getTokenExpirationDate(r){let t;if(t=this.decodeToken(r),!t||!t.hasOwnProperty("exp"))return null;let a=new Date(0);return a.setUTCSeconds(t.exp),a}isTokenExpired(r=this.tokenGetter(),t){return r instanceof Promise?r.then(a=>this._isTokenExpired(a,t)):this._isTokenExpired(r,t)}_isTokenExpired(r,t){if(!r||r==="")return!0;let a=this.getTokenExpirationDate(r);return t=t||0,a===null?!1:!(a.valueOf()>new Date().valueOf()+t*1e3)}getAuthScheme(r,t){return typeof r=="function"?r(t):r}}return p.\u0275fac=function(r){return new(r||p)(L(Oe))},p.\u0275prov=C({token:p,factory:p.\u0275fac}),p})();function Re(p,S){if(p&1&&(e(0,"button",42)(1,"mat-icon",43),n(2,"notifications"),i()(),e(3,"button",44)(4,"mat-icon"),n(5,"account_circle"),i()(),e(6,"mat-menu",10,2)(8,"button",45)(9,"mat-icon"),n(10,"dashboard"),i(),n(11,"Dashboard "),i(),e(12,"button",11)(13,"mat-icon"),n(14,"help"),i(),e(15,"span"),n(16,"Aide"),i()()()),p&2){let r=u(7);m(3),w("matMenuTriggerFor",r),m(3),w("overlapTrigger",!1)}}function Ve(p,S){if(p&1){let r=M();e(0,"button",46),d("click",function(){let a=s(r).$implicit,l=v();return c(l.onChangeRole(a))}),n(1),i()}if(p&2){let r=S.$implicit,t=v();m(),g(" ",t.buildRoleName(r)," ")}}function Ne(p,S){if(p&1&&(n(0),h(1,"br"),n(2)),p&2){let r=v();g(" ",r.authentication.full_name," "),m(2),g(" ",r.roleLabel," ")}}function De(p,S){p&1&&n(0," Utilisateur anonyme ")}var Ie=class p{constructor(S,r){this.stateService=S;this.http=r;if(sessionStorage.getItem("authentication")){this.authentication=JSON.parse(sessionStorage.getItem("authentication")),this.http.authentication=this.authentication;let t=new Ce;this.http.roles=t.decodeToken(this.authentication.authorization).scope,this.http.role=t.decodeToken(this.authentication.authorization).scope,this.roles=this.http.roles.split(" "),this.buildRoles()}A(U).observe([_.XSmall,_.Small,_.Medium,_.Large,_.XLarge]).pipe(y(this.destroyed)).subscribe(t=>{for(let a of Object.keys(t.breakpoints))t.breakpoints[a]&&(this.currentScreenSize=this.displayNameMap.get(a)??"Unknown",this.XSmallOrSmall=this.currentScreenSize==="XSmall"||this.currentScreenSize==="Small",this.stateService.setXSmallOrSmall(this.XSmallOrSmall))})}toggle=!1;switch=!1;currentScreenSize;XSmallOrSmall=!1;destroyed=new b;displayNameMap=new Map([[_.XSmall,"XSmall"],[_.Small,"Small"],[_.Medium,"Medium"],[_.Large,"Large"],[_.XLarge,"XLarge"]]);authentication;header=X(()=>this.stateService.header());roles=[];roleLabel="";ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}onSwitch(){this.switch=!this.switch,document.body.classList.toggle("dark-mode"),this.stateService.setState(this.switch)}buildRoles(){if(sessionStorage.getItem("role")){let S=sessionStorage.getItem("role");this.onChangeRole(S)}else this.http.roles.includes("DIRECTOR")?this.onChangeRole("DIRECTOR"):this.http.roles.includes("SENIOR_ASSISTANT")?this.onChangeRole("SENIOR_ASSISTANT"):this.http.roles.includes("ADMIN_ASSISTANT")?this.onChangeRole("ADMIN_ASSISTANT"):this.http.roles.includes("MAIL_ARCHIVES_AGENT")?this.onChangeRole("MAIL_ARCHIVES_AGENT"):this.http.roles.includes("EXECUTIVE_SECRETARY")?this.onChangeRole("EXECUTIVE_SECRETARY"):this.onChangeRole("AGENT")}buildRoleName(S){switch(S){case"DIRECTOR":return"Directeur";case"SENIOR_ASSISTANT":return"Assistant Principal";case"ADMIN_ASSISTANT":return"Assistant Administratif";case"MAIL_ARCHIVES_AGENT":return"Agent Courrier et Archive";case"EXECUTIVE_SECRETARY":return"Secr\xE9taire de direction";default:return"Agent"}}onChangeRole(S){this.stateService.setRole(S),this.roleLabel=this.buildRoleName(S),sessionStorage.setItem("role",S)}static \u0275fac=function(r){return new(r||p)(E(ye),E(be))};static \u0275cmp=O({type:p,selectors:[["app-layout-backend-component"]],decls:188,vars:32,consts:[["role",""],["drawer",""],["accountMenu",""],[1,"layout-container"],["color","primary",1,"layout-toolbar","shadow-sm","z-[2]"],["mat-icon-button","",3,"click"],[1,"pl-4","flex","items-center"],["src","assets/images/logo.PNG","alt","Logo CNSSAP",1,"h-8"],[2,"flex","1 1 auto"],["mat-icon-button","",3,"matMenuTriggerFor"],["yPosition","below",3,"overlapTrigger"],["mat-menu-item",""],["mat-icon-button","",1,"ms-3",3,"click"],["color","primary"],[1,"layout-sidenav-container"],["fixedTopGap","56",3,"fixedInViewport","mode","opened"],[1,"p-6","bg-white","min-h-28"],["src","assets/images/avatar.png","alt","avatart",1,"h-16"],[1,"text-right"],["dense","","expanded",""],["matListItemIcon","",1,"me-3"],["dense",""],["routerLink","/dashboard",3,"click"],["routerLinkActive","active","matListItemTitle",""],["routerLink","/aide",3,"click"],["routerLink","/mails/incoming/external",3,"click"],["routerLink","/mails/incoming/internal",3,"click"],["routerLink","/groupes",3,"click"],["routerLink","/groupes/new",3,"click"],["routerLink","/documents",3,"click"],["routerLink","/departments",3,"click"],["routerLink","/functions",3,"click"],["routerLink","/users",3,"click"],[1,"min-h-full","flex","flex-col","bg-[#f0f3f5]"],[1,"p-5","bg-[#f7f9fa]","flex","gap-5","items-center"],[1,"bg-white","p-4","shadow-lg"],[2,"color","#f9d4dd"],[1,"app-text-title"],[1,"page-title-subheading","lg:mt-1"],[1,"mx-3.5","md:mx-6","my-6","md:my-8"],[1,"bg-[#fafbfc]","mt-auto","p-4","sm:p-6","shadow-lg","shadow-black"],[1,"text-center"],["mat-icon-button","",1,"me-1"],["matBadge","15","matBadgeColor","accent"],["mat-icon-button","","matTooltip","My Account",3,"matMenuTriggerFor"],["mat-menu-item","","routerLink","/"],["mat-menu-item","",3,"click"]],template:function(r,t){if(r&1){let a=M();e(0,"div",3)(1,"mat-toolbar",4)(2,"button",5),d("click",function(){s(a);let o=u(22);return c(o.toggle())}),e(3,"mat-icon"),n(4,"menu"),i()(),e(5,"div",6),h(6,"img",7),i(),h(7,"span",8),e(8,"div"),x(9,Re,17,2),e(10,"button",9)(11,"mat-icon"),n(12,"keyboard_arrow_down"),i()(),e(13,"mat-menu",10,0),N(15,Ve,2,1,"button",11,V),i(),e(17,"button",12),d("click",function(){return s(a),c(t.onSwitch())}),e(18,"mat-icon",13),n(19),i()()()(),e(20,"mat-sidenav-container",14)(21,"mat-sidenav",15,1)(23,"div",16),h(24,"img",17),e(25,"div",18),x(26,Ne,3,2)(27,De,1,0),h(28,"br"),i()(),e(29,"mat-accordion"),h(30,"mat-divider"),e(31,"mat-expansion-panel",19)(32,"mat-expansion-panel-header")(33,"mat-icon",20),n(34,"home"),i(),n(35,"\xA0Accueil "),i(),e(36,"mat-nav-list",21)(37,"mat-list-item",22),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(38,"mat-icon",20),n(39,"dashboard"),i(),e(40,"span",23),n(41,"Dashboard"),i()(),e(42,"mat-list-item",24),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(43,"mat-icon",20),n(44,"help"),i(),e(45,"span",23),n(46,"Aide"),i()(),e(47,"mat-list-item",24),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(48,"mat-icon",20),n(49,"question_answer"),i(),e(50,"span",23),n(51,"A propos"),i()()()(),h(52,"mat-divider"),e(53,"mat-expansion-panel",21)(54,"mat-expansion-panel-header")(55,"mat-icon",20),n(56,"trending_down"),i(),n(57,"\xA0Courries entrants "),i(),e(58,"mat-nav-list",21)(59,"mat-list-item",25),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(60,"mat-icon",20),n(61,"call_made"),i(),e(62,"span",23),n(63,"Externes"),i()(),e(64,"mat-list-item",26),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(65,"mat-icon",20),n(66,"call_received"),i(),e(67,"span",23),n(68,"Internes"),i()()()(),h(69,"mat-divider"),e(70,"mat-expansion-panel",21)(71,"mat-expansion-panel-header")(72,"mat-icon",20),n(73,"trending_up"),i(),n(74,"\xA0Courriers sortants "),i(),e(75,"mat-nav-list",21)(76,"mat-list-item",27),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(77,"mat-icon",20),n(78,"supervisor_account"),i(),e(79,"span",23),n(80,"Externes"),i()(),e(81,"mat-list-item",28),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(82,"mat-icon",20),n(83,"settings_applications"),i(),e(84,"span",23),n(85,"Internes"),i()()()(),h(86,"mat-divider"),e(87,"mat-expansion-panel",21)(88,"mat-expansion-panel-header")(89,"mat-icon",20),n(90,"folder"),i(),n(91,"\xA0Types documents "),i(),e(92,"mat-nav-list",21)(93,"mat-list-item",29),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(94,"mat-icon",20),n(95,"list"),i(),e(96,"span",23),n(97,"Tous les types"),i()(),e(98,"mat-list-item",28),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(99,"mat-icon",20),n(100,"add"),i(),e(101,"span",23),n(102,"Nouveau type"),i()()()(),h(103,"mat-divider"),e(104,"mat-expansion-panel",21)(105,"mat-expansion-panel-header")(106,"mat-icon",20),n(107,"event_seat"),i(),n(108,"\xA0Gestion des directions "),i(),e(109,"mat-nav-list",21)(110,"mat-list-item",30),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(111,"mat-icon",20),n(112,"list"),i(),e(113,"span",23),n(114,"Toutes les directions"),i()(),e(115,"mat-list-item",28),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(116,"mat-icon",20),n(117,"add"),i(),e(118,"span",23),n(119,"Nouvelle direction"),i()()()(),h(120,"mat-divider"),e(121,"mat-expansion-panel",21)(122,"mat-expansion-panel-header")(123,"mat-icon",20),n(124,"work_outline"),i(),n(125,"\xA0Gestion des fonctions "),i(),e(126,"mat-nav-list",21)(127,"mat-list-item",31),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(128,"mat-icon",20),n(129,"list"),i(),e(130,"span",23),n(131,"Toutes les fonctions"),i()(),e(132,"mat-list-item",28),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(133,"mat-icon",20),n(134,"add"),i(),e(135,"span",23),n(136,"Noulle fonction"),i()()()(),h(137,"mat-divider"),e(138,"mat-expansion-panel",21)(139,"mat-expansion-panel-header")(140,"mat-icon",20),n(141,"people"),i(),n(142,"\xA0Gestion des utilisateurs "),i(),e(143,"mat-nav-list",21)(144,"mat-list-item",32),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(145,"mat-icon",20),n(146,"list"),i(),e(147,"span",23),n(148,"Tous les utilisateurs"),i()(),e(149,"mat-list-item",22),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(150,"mat-icon",20),n(151,"add"),i(),e(152,"span",23),n(153,"Nouveau utilisateur"),i()()()(),h(154,"mat-divider"),e(155,"mat-expansion-panel",21)(156,"mat-expansion-panel-header")(157,"mat-icon",20),n(158,"devices"),i(),n(159,"\xA0Courriers archiv\xE9s "),i(),e(160,"mat-nav-list",21)(161,"mat-list-item",27),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(162,"mat-icon",20),n(163,"send"),i(),e(164,"span",23),n(165,"Invitations"),i()(),e(166,"mat-list-item",28),d("click",function(){s(a);let o=u(22);return c(o.toggle(!t.XSmallOrSmall))}),e(167,"mat-icon",20),n(168,"weekend"),i(),e(169,"span",23),n(170,"Ticket"),i()()()(),h(171,"mat-divider"),i()(),e(172,"mat-sidenav-content")(173,"div",33)(174,"div",34)(175,"div",35)(176,"mat-icon",36),n(177),i()(),e(178,"div")(179,"span",37),n(180),i(),e(181,"div",38),n(182),i()()(),e(183,"main",39),h(184,"router-outlet"),i(),e(185,"footer",40)(186,"p",41),n(187,"\xA9 Copyright 2025 CNSSAP"),i()()()()()()}if(r&2){let a=u(14);f("layout-is-mobile",t.XSmallOrSmall),m(9),T(t.XSmallOrSmall?-1:9),m(),w("matMenuTriggerFor",a),m(3),w("overlapTrigger",!1),m(2),D(t.roles),m(4),g(" ",t.switch?"wb_sunny":"brightness_2"," "),m(),B("margin-top",t.XSmallOrSmall?56:0,"px"),m(),w("fixedInViewport",t.XSmallOrSmall)("mode",t.XSmallOrSmall?"over":"side")("opened",t.XSmallOrSmall===!1),R("role",t.XSmallOrSmall?"dialog":"navigation"),m(5),T(t.authentication?26:27),m(5),f("mat-elevation-z0",!0),m(22),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(17),f("mat-elevation-z0",!0),m(22),g(" ",t.header().icon," "),m(3),g(" ",t.header().title," "),m(2),g(" ",t.header().subTitle," ")}},dependencies:[P,F,J,$,W,H,j,G,z,Y,q,Q,K,Z,ne,ie,ee,te,re,ae,oe,me,le,ce,se,de,ue,Se,pe,_e,he,we,ge,ke,fe,Me,Te,xe,Ee,ve],styles:["mat-sidenav[_ngcontent-%COMP%]{width:290px;border-radius:0;box-shadow:3px 0 8px #0000001a}.bg-footer[_ngcontent-%COMP%]{background:#fafbfc}"]})};export{Ie as LayoutBackendComponent};
