import{b as z,c as K,f as Q,g as le,h as me,i as Z,k as ee,r as te}from"./chunk-WO3WQ2XR.js";import{a as X,b as q}from"./chunk-OYAAD6H2.js";import{a as J}from"./chunk-NS5OZLHL.js";import{B as j,G as H,H as V,I as $,K as G,b as I,g as U,l as F,s as L,v as N,x as P,z as O}from"./chunk-JQ7ZTRAQ.js";import{a as W}from"./chunk-XHZ33VBC.js";import{P as B,V as T,_ as D,la as k,ma as w}from"./chunk-4LHVJXPR.js";import{C as R,k as x}from"./chunk-SMWCLUEH.js";import{a as ae,b as Y}from"./chunk-VYQ2GNAY.js";import{$a as d,Ab as v,Eb as a,Fb as s,Gb as o,Hb as c,Mb as se,Qb as g,S as M,Sb as f,Wa as r,cc as ne,ec as l,f as S,ga as b,gb as A,gc as re,ha as h,ic as _,jc as C,kc as E,xc as y,zb as p}from"./chunk-JOOEKZTP.js";import"./chunk-2VMXMS7J.js";var ie=class{constructor(i,t){this.id=i;this.name=t}};function Pe(n,i){if(n&1&&(s(0,"p",3),l(1),o()),n&2){let t=f();r(),re(" ",t.roleDescription," ")}}function Oe(n,i){n&1&&c(0,"mat-progress-bar",5)}var oe=class n{constructor(i,t,e){this.http=i;this.message=t;this.stateService=e}unsubscribe$=new S;roleBdd;roleLabel;roleDescription;user;isAccountActive;start=!1;loader=!1;disable;xSmallOrSmall=y(()=>this.stateService.XSmallOrSmall());ngOnInit(){this.disable=this.hasRole(this.roleBdd)}hasRole(i){return this.user.roles.some(t=>t.name===i)}onToggleChange(){this.disable?this.removeRoleFromUser():this.addRoleToUser()}addRoleToUser(){this.loader=!0,this.http.url=`users/${this.user.id}/roles/${this.roleBdd}`,this.unsubscribe$.next(),this.http.update(null).pipe(M(this.unsubscribe$)).subscribe({error:i=>{this.loader=!0,this.message.openSnackBar(i,"Fermer",4e3)},complete:()=>{this.loader=!1,this.disable=!0,this.user.roles.push(new ie(void 0,this.roleBdd)),sessionStorage.setItem("user",JSON.stringify(this.user)),this.message.openSnackBar("Le r\xF4le a \xE9t\xE9 attribu\xE9 avec succ\xE8s","Fermer",4e3)}})}removeRoleFromUser(){this.loader=!0,this.http.url=`users/${this.user.id}/roles/${this.roleBdd}`,this.unsubscribe$.next(),this.http.delete().pipe(M(this.unsubscribe$)).subscribe({error:i=>{this.loader=!1,this.message.openSnackBar(i,"Fermer",4e3)},complete:()=>{this.loader=!1,this.disable=!1;let i=this.user.roles.findIndex(t=>t.name===this.roleBdd);i!==-1&&this.user.roles.splice(i,1),sessionStorage.setItem("user",JSON.stringify(this.user)),this.message.openSnackBar("Le r\xF4le a \xE9t\xE9 retir\xE9 avec succ\xE8s","Fermer",4e3)}})}static \u0275fac=function(t){return new(t||n)(d(W),d(J),d(Y))};static \u0275cmp=A({type:n,selectors:[["app-role-item-component"]],inputs:{roleBdd:"roleBdd",roleLabel:"roleLabel",roleDescription:"roleDescription",user:"user",isAccountActive:"isAccountActive",start:"start"},decls:8,vars:13,consts:[[1,"flex","flex-col"],[1,"flex","items-center","justify-between","py-2.5","md:py-4","md:p-4","border-gray-200",3,"click"],[1,"text-base","md:text-lg","text-gray-700"],[1,"text-base","text-gray-500"],[3,"ngModelChange","click","ngModel","disabled"],["mode","indeterminate"]],template:function(t,e){t&1&&(s(0,"div",0)(1,"div",1),g("click",function(){return e.isAccountActive&&e.onToggleChange()}),s(2,"div")(3,"p",2),l(4),o(),p(5,Pe,2,1,"p",3),o(),s(6,"mat-slide-toggle",4),E("ngModelChange",function(u){return C(e.disable,u)||(e.disable=u),u}),g("click",function(u){return u.stopPropagation()}),o()(),p(7,Oe,1,0,"mat-progress-bar",5),o()),t&2&&(r(),ne("cursor-pointer",e.isAccountActive)("hover:bg-gray-50",e.isAccountActive)("border-t",!e.start)("opacity-50",!e.isAccountActive),r(3),re(" ",e.roleLabel," "),r(),v(e.xSmallOrSmall()?-1:5),r(),_("ngModel",e.disable),a("disabled",!e.isAccountActive),r(),v(e.loader?7:-1))},dependencies:[z,K,Q,Z,ee,L,F,q,X,te,x,I,B,R,w,T,U,N,P,O,j,H,$,V,G,k,D],encapsulation:2})};function je(n,i){n&1&&(s(0,"p",12),l(1," Activer ou d\xE9sactiver l\u2019acc\xE8s de cet utilisateur \xE0 son compte pour contr\xF4ler sa connexion au syst\xE8me "),o())}function He(n,i){n&1&&c(0,"mat-progress-bar",14)}function Ve(n,i){if(n&1){let t=se();s(0,"div",2)(1,"h2",3),l(2,"Gestion du Compte Utilisateur"),o(),s(3,"div",4)(4,"div",9)(5,"div",10),g("click",function(){b(t);let m=f();return h(m.onAccountStatusClick())}),s(6,"div")(7,"p",11),l(8,"Activation du Compte"),o(),p(9,je,2,0,"p",12),o(),s(10,"mat-slide-toggle",13),E("ngModelChange",function(m){b(t);let u=f();return C(u.isAccountActive,m)||(u.isAccountActive=m),h(m)}),g("click",function(m){return b(t),h(m.stopPropagation())}),o()(),p(11,He,1,0,"mat-progress-bar",14),o()()()}if(n&2){let t=f();r(9),v(t.xSmallOrSmall()?-1:9),r(),_("ngModel",t.isAccountActive),r(),v(t.loader?11:-1)}}var ce=class n{constructor(i,t,e){this.stateService=i;this.http=t;this.message=e;this.user=JSON.parse(sessionStorage.getItem("user")),this.stateService.setHeader(new ae(this.user.full_name.toUpperCase(),`${this.user.roles.length} r\xF4le(s) attribu\xE9(s) \xE0 cet utilisateur`,"home")),this.isAccountActive=this.user.is_active}unsubscribe$=new S;user;xSmallOrSmall=y(()=>this.stateService.XSmallOrSmall());roleStates={};isAccountActive;is_admin=!1;loader=!1;onAccountStatusClick(){this.isAccountActive=!this.isAccountActive,this.toggleAccountStatus()}toggleAccountStatus(){this.http.url=`users/${this.user.id}/toggle-status`,this.http.update(null).pipe(M(this.unsubscribe$)).subscribe({next:()=>{this.user.is_active=!this.user.is_active},error:i=>{this.message.openSnackBar(i,"Fermer",4e3),this.isAccountActive=!this.isAccountActive},complete:()=>{this.message.openSnackBar("Le statut du compte a \xE9t\xE9 mis \xE0 jour avec succ\xE8s.","Fermer",4e3)}})}static \u0275fac=function(t){return new(t||n)(d(Y),d(W),d(J))};static \u0275cmp=A({type:n,selectors:[["app-roles-user-component"]],decls:28,vars:45,consts:[["mat-stretch-tabs","false","mat-align-tabs","start"],["label","R\xF4les utilisateur"],[1,"w-[99%]","md:w-1/2","mx-auto","my-8"],[1,"text-lg","md:text-xl","font-semibold","text-gray-800","mb-4"],[1,"md:bg-white","md:rounded-lg","md:shadow-md","overflow-hidden"],[3,"start","user","isAccountActive","roleBdd","roleLabel","roleDescription"],[1,"text-xl","font-semibold","text-gray-800","mb-4"],[3,"user","isAccountActive","roleBdd","roleLabel","roleDescription"],["label","Historique des connexions"],[1,"flex","flex-col"],[1,"flex","items-center","justify-between","py-2.5","md:py-4","md:p-4","border-gray-200","cursor-pointer","hover:bg-gray-50",3,"click"],[1,"text-base","md:text-lg","text-gray-700"],[1,"text-base","text-gray-500"],[3,"ngModelChange","click","ngModel"],["mode","indeterminate"]],template:function(t,e){t&1&&(s(0,"mat-tab-group",0)(1,"mat-tab",1),p(2,Ve,12,3,"div",2),s(3,"div",2)(4,"h2",3),l(5,"R\xF4les des Directeurs"),o(),s(6,"div",4),c(7,"app-role-item-component",5),o()(),s(8,"div",2)(9,"h2",6),l(10,"R\xF4les des Assistants"),o(),s(11,"div",4),c(12,"app-role-item-component",5)(13,"app-role-item-component",7)(14,"app-role-item-component",7),o()(),s(15,"div",2)(16,"h2",6),l(17,"R\xF4les des Agents"),o(),s(18,"div",4),c(19,"app-role-item-component",5)(20,"app-role-item-component",7),o()(),s(21,"div",2)(22,"h2",6),l(23,"Autres r\xF4les"),o(),s(24,"div",4),c(25,"app-role-item-component",5)(26,"app-role-item-component",7),o()()(),c(27,"mat-tab",8),o()),t&2&&(r(2),v(e.is_admin?-1:2),r(5),a("start",!0)("user",e.user)("isAccountActive",e.isAccountActive)("roleBdd","DIRECTOR")("roleLabel","Directeur (G\xE9n\xE9ral, G\xE9n\xE9ral Adjoin, Des ressources Humaines)")("roleDescription","Pour la lecture, l\u2019orientation et le traitement final des courriers internes et externes"),r(5),a("start",!0)("user",e.user)("isAccountActive",e.isAccountActive)("roleBdd","SENIOR_ASSISTANT")("roleLabel","Assistant Principal")("roleDescription","Responsabilit\xE9s pour l\u2019orientation des courriers vers les Directeurs et le suivi des traitements"),r(),a("user",e.user)("isAccountActive",e.isAccountActive)("roleBdd","ADMIN_ASSISTANT")("roleLabel","Assistant Administratif")("roleDescription","Responsabilit\xE9s pour la r\xE9ception, l\u2019annotation et le suivi des courriers entrants et sortants"),r(),a("user",e.user)("isAccountActive",e.isAccountActive)("roleBdd","EXECUTIVE_SECRETARY")("roleLabel","Secr\xE9taire de Direction")("roleDescription","Responsabilit\xE9s pour l\u2019enregistrement, le scan et le suivi des courriers internes et sign\xE9s"),r(5),a("start",!0)("user",e.user)("isAccountActive",e.isAccountActive)("roleBdd","MAIL_ARCHIVES_AGENT")("roleLabel","Agent Courrier et Archives")("roleDescription","Responsabilit\xE9s pour l\u2019enregistrement, le scan et l\u2019archivage des courriers entrants et sortants"),r(),a("user",e.user)("isAccountActive",e.isAccountActive)("roleBdd","AGENT")("roleLabel","Agent Simple")("roleDescription","Responsabilit\xE9s de l\u2019Agent pour la r\xE9daction, l\u2019envoi et la r\xE9ception des courriers administratifs"),r(5),a("start",!0)("user",e.user)("isAccountActive",e.isAccountActive)("roleBdd","ADMIN")("roleLabel","Administrateur Syst\xE8me")("roleDescription","Gestion et supervision des infrastructures, serveurs, s\xE9curit\xE9 et maintenance syst\xE8me."),r(),a("user",e.user)("isAccountActive",e.isAccountActive)("roleBdd","SUPER_USER")("roleLabel","Super Utilisateur")("roleDescription","Acc\xE8s complet pour g\xE9rer utilisateurs, permissions et configurations critiques."))},dependencies:[z,K,Q,Z,le,me,ee,L,F,q,X,te,x,I,B,R,w,T,U,N,P,O,j,H,$,V,G,k,D,oe],encapsulation:2})};export{ce as RolesUserComponent};
