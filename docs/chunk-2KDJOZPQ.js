import{o as n,q as u,s as c,t as d}from"./chunk-DDJAZSWD.js";import{A as a,Y as l,aa as p,j as h}from"./chunk-D6M5U3FV.js";var b=class o{constructor(t){this.http=t}_url;_baseUrl="https://mail-cnssap-backend.onrender.com/";isAuthentifier=!1;_authentication;_roles;_role;get url(){return this._url}set url(t){this._url=this._baseUrl+t}get roles(){return this._roles}set roles(t){this._roles=t}get role(){return this._role}set role(t){this._role=t}get baseUrl(){return this._baseUrl}get(t){return this.http.get(this._url,{headers:this.getHeader(),params:t}).pipe(a(e=>this.handleError(e)))}save(t,e){return this.http.post(this._url,t,{headers:this.getHeader(),params:e}).pipe(a(r=>this.handleError(r)))}register(t){return this.http.post(this._url,t).pipe(a(e=>this.handleError(e)))}update(t,e){return console.log(t),this.http.patch(this._url,t,{headers:this.getHeader(),params:e}).pipe(a(r=>this.handleError(r)))}delete(t){return this.http.delete(this._url,{headers:this.getHeader(),params:t}).pipe(a(e=>this.handleError(e)))}getHeader(){return new n({"Content-Type":"application/json",Authorization:this._authentication.authorization})}login(t){return this.http.post(this._url,t)}handleError(t){let e="";return t instanceof c?t.status===0?e="Aucune connexion internet. veillez r\xE9essayer plus tard":t.status===401?e="impossible d'acc\xE8der aux ressources. veillez r\xE9essayer plus tard":t.status===403?e="Vous n'avez pas le droit de faire cette action":e=t.error.message:t instanceof ErrorEvent?e=t.error.message:e="Une erreur est survenue. Veillez r\xE9essayer plus tard.",h(Promise.reject(e))}set authentication(t){this._authentication=t}get authentication(){return this._authentication}savaAndFile(t,e){let r=new FormData;t.forEach(i=>{r.append("files",i)}),r.append("contenu",JSON.stringify(e));let s=new u("POST",this._url,r,{headers:new n({Authorization:this._authentication.authorization}),reportProgress:!0,responseType:"text"});return this.http.request(s)}sendFormData(t,e=null,r="post"){let s;typeof t=="string"?s=t:s=JSON.stringify(t),console.log(s);let i=new FormData;return i.append("data",s),e&&i.append("file",e,e.name),r==="post"?this.http.post(this._url,i,{reportProgress:!0,observe:"events",headers:new n({Authorization:this._authentication.authorization})}):this.http.patch(this._url,i,{reportProgress:!0,observe:"events",headers:new n({Authorization:this._authentication.authorization})})}getPdfDocument(){return this.http.get(this._url,{responseType:"blob",headers:this.getHeader()})}getFile(){return this.http.get(this._url,{responseType:"arraybuffer",headers:this.getHeader()})}static \u0275fac=function(e){return new(e||o)(p(d))};static \u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})};export{b as a};
