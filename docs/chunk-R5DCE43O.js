import{a as $e}from"./chunk-3FL5NVVI.js";import{a as X,b as we,c as ke,d as Te,f as Ie,g as Fe}from"./chunk-4OPMYXIF.js";import{a as Le,b as Oe,c as Be,d as Pe,e as Ve,f as He,i as Ne,k as Ae,r as Re}from"./chunk-XO34ZB7H.js";import{b as ye}from"./chunk-YXRGR7ZY.js";import{a as q}from"./chunk-FKLYTB4I.js";import{a as De}from"./chunk-Y3YQYZ4W.js";import{A as Ce,B as $,G as z,I as G,K as U,a as k,b as T,c as ue,d as ge,e as fe,f as he,g as P,l as V,n as xe,o as Me,r as be,s as H,u as Se,v as N,x as A,y as ve,z as R}from"./chunk-K6XTAWVM.js";import{a as j}from"./chunk-VBGLGRB2.js";import{$ as se,M as I,O as oe,P as F,R as L,T as h,V as O,W as me,X as le,Z as S,ba as de,ca as pe,da as ce,ma as B}from"./chunk-BQFQ236X.js";import{C as w,d as ae,k as E}from"./chunk-PS6WXRYG.js";import{a as _e,b as Ee}from"./chunk-HYQRV22J.js";import{Ab as b,Cb as Y,Db as ee,Eb as c,Fb as e,Gb as i,Hb as p,Mb as Z,Qb as u,S as x,Sb as f,Wa as l,ac as te,ba as s,ec as n,f as C,fc as ie,ga as y,gb as _,gc as g,ha as D,ia as J,ja as Q,mb as W,oc as re,xc as ne,zb as M}from"./chunk-JPJ72NUK.js";import"./chunk-2VMXMS7J.js";function ot(o,t){if(o&1&&(e(0,"mat-error"),n(1),i()),o&2){let r=f();l(),g(" ",r.getErrorDesignation()," ")}}function mt(o,t){if(o&1&&(e(0,"mat-error"),n(1),i()),o&2){let r=f();l(),g(" ",r.getErrorAcronym()," ")}}var v=class o{dialogRef=s(we);message=s(q);data=s(ke);http=s(j);unsubscribe$=new C;form;department;ngOnInit(){this.initForm()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}initForm(){this.form=new le({designation:new S(this.data.department?this.data.department.designation:"",[h.required,h.minLength(10),h.maxLength(100)]),acronym:new S(this.data.department?this.data.department.acronym:"",[h.required,h.minLength(2),h.maxLength(10)])})}getErrorDesignation(){return this.form.get("designation").hasError("required")?"Ce champ est requis":this.form.get("designation").hasError("minlength")?"La d\xE9signation doit contenir au moins 10 caract\xE8res.":this.form.get("designation").hasError("maxlength")?"La d\xE9signation ne peut pas d\xE9passer 100 caract\xE8res.":""}getErrorAcronym(){return this.form.get("acronym").hasError("required")?"Ce champ est requis":this.form.get("acronym").hasError("minlength")?"L'acronyme doit contenir au moins 2 caract\xE8res.":this.form.get("acronym").hasError("maxlength")?"L'acronyme ne peut pas d\xE9passer 10 caract\xE8res.":""}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched(),this.message.openSnackBar("Veuillez corriger les erreurs du formulaire.","Fermer",4e3);return}this.data.target==="add"?this.add():this.update()}add(){this.http.url="departments",this.http.save(this.form.value).pipe(x(this.unsubscribe$)).subscribe({next:t=>{this.department=t},error:t=>{this.message.openSnackBar(t,"Fermer",4e3)},complete:()=>{this.message.openSnackBar("Direction ajout\xE9e avec succ\xE8s","Fermer",4e3),this.dialogRef.close(this.department)}})}update(){this.http.url=`departments/${this.data.department.id}`,this.http.update(this.form.value).pipe(x(this.unsubscribe$)).subscribe({next:t=>{this.department=t},error:t=>{this.message.openSnackBar(t,"Fermer",4e3)},complete:()=>{this.message.openSnackBar("Direction modifi\xE9e avec succ\xE8s","Fermer",4e3),this.dialogRef.close(this.department)}})}onClose(){this.dialogRef.close()}static \u0275fac=function(r){return new(r||o)};static \u0275cmp=_({type:o,selectors:[["app-department-edit-component"]],decls:24,vars:4,consts:[[1,"flex","items-center","justify-between","px-4","py-2","bg-white","dark:bg-gray-900","shadow-sm"],[1,"text-lg","font-semibold","text-gray-800","dark:text-gray-300"],["mat-icon-button","",3,"click"],[1,"-mx-3","md:-mx-0",3,"ngSubmit","formGroup"],[1,"w-full","mt-1"],[1,"w-full"],["type","text","matInput","","formControlName","designation"],["type","text","matInput","","formControlName","acronym"],[1,"mt-5"],[1,"border-gray-300"],["mat-flat-button","","cdkFocusInitial","",3,"click"]],template:function(r,a){if(r&1&&(e(0,"div",0)(1,"h2",1),n(2),i(),e(3,"button",2),u("click",function(){return a.onClose()}),e(4,"mat-icon"),n(5,"close"),i()()(),e(6,"mat-dialog-content")(7,"form",3),u("ngSubmit",function(){return a.onSubmit()}),e(8,"div",4)(9,"mat-form-field",5)(10,"mat-label"),n(11,"D\xE9signation de la direction"),i(),p(12,"input",6),M(13,ot,2,1,"mat-error"),i(),e(14,"mat-form-field",5)(15,"mat-label"),n(16,"Acronyme de la direction"),i(),p(17,"input",7),M(18,mt,2,1,"mat-error"),i()()()(),e(19,"div",8),p(20,"hr",9),i(),e(21,"mat-dialog-actions")(22,"button",10),u("click",function(){return a.onSubmit()}),n(23," Enregister "),i()()),r&2){let m,d;l(2),g(" ",a.data.title," "),l(5),c("formGroup",a.form),l(6),b((m=a.form.get("designation"))!=null&&m.hasError?13:-1),l(5),b((d=a.form.get("acronym"))!=null&&d.hasError?18:-1)}},dependencies:[Ie,Fe,E,T,k,F,oe,I,w,B,se,L,O,me,pe,ce,P,V,H,be,xe,Me,N,Se,A,R,$,z,G,U],styles:[".mat-mdc-dialog-container .mdc-dialog__surface{border-radius:0!important}"]})};var lt=o=>({item:o}),st=(o,t)=>t.id;function dt(o,t){if(o&1&&(e(0,"span",3),n(1),i()),o&2){let r=f();l(),g(" Toutes les directions (",r.allUDepartments.length,") ")}}function pt(o,t){o&1&&(e(0,"mat-button-toggle-group",12)(1,"mat-button-toggle",33)(2,"span"),n(3,"Affichage Grille"),i(),e(4,"mat-icon",34),n(5,"view_list"),i()(),e(6,"mat-button-toggle",35)(7,"span"),n(8,"Affichage tableau"),i(),e(9,"mat-icon",34),n(10,"view_module"),i()()())}function ct(o,t){if(o&1&&(e(0,"tr")(1,"td",36)(2,"div")(3,"h4",37),n(4),i()()(),e(5,"td",36)(6,"div")(7,"h2",38),n(8),i()()(),e(9,"td",39),n(10),i(),e(11,"td",36)(12,"button",40)(13,"mat-icon"),n(14,"more_vert"),i()()()()),o&2){let r=t.$implicit,a=t.$index;f();let m=te(45);l(4),ie(a+1),l(4),g(" ",r.designation," "),l(2),g(" ",r.acronym," "),l(2),c("matMenuTriggerFor",m)("matMenuTriggerData",re(5,lt,r))}}function ut(o,t){if(o&1){let r=Z();e(0,"button",41),u("click",function(){let m=y(r).item,d=f();return D(d.onUpdateDialog(m))}),e(1,"mat-icon"),n(2,"edit"),i(),n(3,"Modifier "),i(),e(4,"button",42)(5,"mat-icon"),n(6,"person"),i(),e(7,"span"),n(8,"Directeur"),i()(),p(9,"mat-divider"),e(10,"button",42)(11,"mat-icon"),n(12,"delete"),i(),e(13,"span"),n(14,"Supprimer"),i()()}}var ze=class o{http=s(j);message=s(q);stateService=s(Ee);dialog=s(Te);xSmallOrSmall=ne(()=>this.stateService.XSmallOrSmall());unsubscribe$=new C;loading=!1;allUDepartments=[];filteredDepartments=[];paginatedDepartments=[];totalLength=0;currentPage=0;pageSizeOptions=[6,10,15,20];pageSize=this.pageSizeOptions[0];searchKeyword=new S("");roles=De;constructor(){this.stateService.setHeader(new _e("GESTION DES DIRECTIONS","Liste des toutes les directions","event_seat"))}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnInit(){this.onGet(),this.setupSearch()}onGet(){this.loading=!0,this.http.url="departments",this.unsubscribe$.next(),this.http.get().pipe(x(this.unsubscribe$)).subscribe({next:t=>{this.allUDepartments=t,this.filteredDepartments=t},error:t=>{this.loading=!1,this.message.openSnackBar(t,"Fermer",800)},complete:()=>{this.loading=!1,this.totalLength=this.filteredDepartments.length,this.updatePaginated()}})}setupSearch(){this.searchKeyword.valueChanges.pipe(x(this.unsubscribe$)).subscribe(t=>{this.applyFilter(t)})}applyFilter(t){let r=t?t.toLowerCase().trim():"";this.filteredDepartments=this.allUDepartments.filter(a=>a.designation.toLowerCase().includes(r)),this.totalLength=this.filteredDepartments.length,this.currentPage=0,this.updatePaginated()}updatePaginated(){let t=this.currentPage*this.pageSize,r=t+this.pageSize;this.paginatedDepartments=this.filteredDepartments.slice(t,r)}onPageChange(t){this.currentPage=t.pageIndex,this.pageSize=t.pageSize,this.updatePaginated()}onAddDialog(t){let r=new X;r.disableClose=!0,r.data={title:"Ajouter une direction",department:t,target:"add"},this.dialog.open(v,r).afterClosed().subscribe(m=>{m&&(this.allUDepartments.push(m),this.applyFilter(this.searchKeyword.value))})}onUpdateDialog(t){let r=new X;r.disableClose=!0,r.data={title:"Modifier une direction",department:t,target:"edit"},this.dialog.open(v,r).afterClosed().subscribe(m=>{if(m){let d=this.filteredDepartments.findIndex(K=>K.id===m.id);d!==-1&&(this.filteredDepartments[d]=m,this.updatePaginated())}})}static \u0275fac=function(r){return new(r||o)};static \u0275cmp=_({type:o,selectors:[["app-department-component"]],decls:48,vars:9,consts:[["menu","matMenu"],[1,"flex","items-center","justify-between","md:h-16","md:px-4","border-b","border-b-gray-300","md:border-b-0","py-2","md:py-0",3,"ngClass"],[1,"flex","gap-2"],[1,"text-lg"],["mat-icon-button","","matTooltip","Nouveau courrier",3,"click"],["mat-icon-button","","matTooltip","Imprimer"],[1,"flex","flex-wrap","my-4","md:mt-6"],[1,"w-full","lg:w-4/12"],[1,"relative","w-full"],["type","text","placeholder","Rechercher un courrier par mot cl\xE9",1,"w-full","p-3","pl-5","pr-15","text-lg","border-2","border-gray-300","md:rounded-full","outline-none","transition","duration-300","focus:border-blue-500","focus:text-gray-700","bg-white","h-[45px]","lg:h-[49px]",3,"formControl"],[1,"absolute","right-4","top-1/2","transform","-translate-y-1/2","text-gray-500","text-lg"],[1,"w-full","lg:w-8/12","flex","justify-end","items-center","flex-wrap","mt-3","md:mt-0"],["value","add"],[1,"flex","flex-col","md:mt-6"],[1,"overflow-x-auto"],[1,"inline-block","min-w-full","align-middle"],[1,"overflow-hidden","border-y","border-gray-200","dark:border-gray-700","md:rounded-lg"],[1,"min-w-full","divide-y","divide-gray-200","dark:divide-gray-700"],[1,"bg-gray-50","dark:bg-gray-800"],["scope","col",1,"px-4","py-3.5","text-sm","font-normal","text-left","rtl:text-right","text-gray-500","dark:text-gray-400"],["scope","col",1,"py-3.5","px-4","text-sm","font-normal","text-left","rtl:text-right","text-gray-500","dark:text-gray-400"],[1,"flex","items-center","gap-x-3","focus:outline-none"],["viewBox","0 0 10 11","fill","none","xmlns","http://www.w3.org/2000/svg",1,"h-3"],["d","M2.13347 0.0999756H2.98516L5.01902 4.79058H3.86226L3.45549 3.79907H1.63772L1.24366 4.79058H0.0996094L2.13347 0.0999756ZM2.54025 1.46012L1.96822 2.92196H3.11227L2.54025 1.46012Z","fill","currentColor","stroke","currentColor","stroke-width","0.1"],["d","M0.722656 9.60832L3.09974 6.78633H0.811638V5.87109H4.35819V6.78633L2.01925 9.60832H4.43446V10.5617H0.722656V9.60832Z","fill","currentColor","stroke","currentColor","stroke-width","0.1"],["d","M8.45558 7.25664V7.40664H8.60558H9.66065C9.72481 7.40664 9.74667 7.42274 9.75141 7.42691C9.75148 7.42808 9.75146 7.42993 9.75116 7.43262C9.75001 7.44265 9.74458 7.46304 9.72525 7.49314C9.72522 7.4932 9.72518 7.49326 9.72514 7.49332L7.86959 10.3529L7.86924 10.3534C7.83227 10.4109 7.79863 10.418 7.78568 10.418C7.77272 10.418 7.73908 10.4109 7.70211 10.3534L7.70177 10.3529L5.84621 7.49332C5.84617 7.49325 5.84612 7.49318 5.84608 7.49311C5.82677 7.46302 5.82135 7.44264 5.8202 7.43262C5.81989 7.42993 5.81987 7.42808 5.81994 7.42691C5.82469 7.42274 5.84655 7.40664 5.91071 7.40664H6.96578H7.11578V7.25664V0.633865C7.11578 0.42434 7.29014 0.249976 7.49967 0.249976H8.07169C8.28121 0.249976 8.45558 0.42434 8.45558 0.633865V7.25664Z","fill","currentColor","stroke","currentColor","stroke-width","0.3"],["scope","col",1,"px-12","py-3.5","text-sm","font-normal","text-left","rtl:text-right","text-gray-500","dark:text-gray-400"],["scope","col",1,"relative","py-3.5","px-4"],[1,"sr-only"],[1,"bg-white","divide-y","divide-gray-200","dark:divide-gray-700","dark:bg-gray-900"],["yPosition","below",3,"overlapTrigger"],["matMenuContent",""],["showFirstLastButtons","",1,"mt-10",3,"page","length","pageSize","pageSizeOptions","pageIndex"],["matTooltip","Nouveau groupe","value","add","aria-label","Text align center"],["color","primary"],["matTooltip","Liste des proclamateurs","value","print","aria-label","Text align center"],[1,"px-4","py-2.5","text-sm","whitespace-nowrap"],[1,"text-gray-700","dark:text-gray-200"],[1,"text-gray-800","dark:text-white"],[1,"px-12","py-2.5","text-sm","whitespace-nowrap"],["mat-icon-button","",3,"matMenuTriggerFor","matMenuTriggerData"],["mat-menu-item","",3,"click"],["mat-menu-item",""]],template:function(r,a){if(r&1){let m=Z();e(0,"section",1)(1,"div",2),p(2,"app-back-component"),i(),M(3,dt,2,1,"span",3),e(4,"div")(5,"button",4),u("click",function(){return y(m),D(a.onAddDialog())}),e(6,"mat-icon"),n(7,"add"),i()(),e(8,"button",5)(9,"mat-icon"),n(10,"print"),i()()()(),e(11,"section",6)(12,"div",7)(13,"div",8),p(14,"input",9),e(15,"mat-icon",10),n(16,"search"),i()()(),e(17,"div",11),M(18,pt,11,0,"mat-button-toggle-group",12),i()(),e(19,"div",13)(20,"div",14)(21,"div",15)(22,"div",16)(23,"table",17)(24,"thead",18)(25,"tr")(26,"th",19),n(27," N\xB0 "),i(),e(28,"th",20)(29,"button",21)(30,"span"),n(31,"D\xE9signation"),i(),J(),e(32,"svg",22),p(33,"path",23)(34,"path",24)(35,"path",25),i()()(),Q(),e(36,"th",26),n(37," Acronyme "),i(),e(38,"th",27)(39,"span",28),n(40,"Edit"),i()()()(),e(41,"tbody",29),Y(42,ct,15,7,"tr",null,st),i()()()()()(),e(44,"mat-menu",30,0),W(46,ut,15,0,"ng-template",31),i(),e(47,"mat-paginator",32),u("page",function(K){return y(m),D(a.onPageChange(K))}),i()}r&2&&(c("ngClass",a.xSmallOrSmall()?"":"u-bg-header-main"),l(3),b(a.xSmallOrSmall()?-1:3),l(11),c("formControl",a.searchKeyword),l(4),b(a.xSmallOrSmall()?-1:18),l(24),ee(a.paginatedDepartments),l(2),c("overlapTrigger",!1),l(3),c("length",a.totalLength)("pageSize",a.pageSize)("pageSizeOptions",a.pageSizeOptions)("pageIndex",a.currentPage))},dependencies:[Oe,Le,Be,He,Pe,Ve,Ne,Ae,H,V,ye,Re,E,ae,T,k,F,I,w,B,L,O,de,P,fe,ue,ge,he,N,A,R,ve,$,Ce,z,G,U,$e],encapsulation:2})};export{ze as DepartmentComponent};
